# 加入參考 設備商提供的DLL

因為一般 上傳版控  不會包含bin目錄  
所以 很多專案會在根目錄下建立一個Lib  
把需要的DLL  放進Lib  再加入參考 

```
SVN忽略bin資料夾的原因
bin資料夾是編譯結果，通常不會放版本控制中（如SVN忽略），

但是第三方DLL的原始版本（放在Lib）需要加入版本控制，  
保證其他開發者checkout後能正常編譯。
```

## 如果  設備商  提供的DLL  還會引用BIN內的各種檔案   該如何？

是的，**如果設備商提供的DLL在執行時會依賴 `bin` 資料夾內的其他檔案（例如：設定檔、資料檔、驅動、授權檔、plugin等）**，那你就必須配合他們的結構，這屬於 **runtime dependency（執行階段相依）** 的問題。

---

### ✅ 建議做法（業界實務）

1. **尊重原廠要求的檔案結構**
   如果DLL執行時會去讀取它同目錄或特定子資料夾的檔案，那你就要在 `bin` 下保留它需要的東西。這些檔案一樣需要被打包一起帶走。

2. **建立一個`LibVendorRuntime`資料夾或類似名稱**
   在專案中準備一個目錄放設備商的DLL和附帶檔案（如授權、設定、Plugin），並**在Post-Build事件中複製到`bin`資料夾**。

   #### 例如：在 VS 設定 Post-build 事件

   在專案屬性 → Build Events → Post-build event command line：

   ```cmd
   xcopy "$(ProjectDir)LibVendorRuntime\*.*" "$(TargetDir)" /E /Y /I
   ```

   * `/E`：包含子資料夾
   * `/Y`：自動覆蓋
   * `/I`：預設目的地為資料夾

3. **這樣做的好處**：

   * 原始DLL與相依檔案統一管理在專案資料夾中
   * `bin`保持乾淨，只作為執行用途
   * SVN不需要提交`bin`，只要提交`LibVendorRuntime`即可，其他開發者也能Build並Run

---

### 🔁 如果你不能改變DLL的路徑邏輯？

若設備商的DLL是**硬編碼路徑**（例如一定要從EXE旁邊的某個目錄讀檔），那就沒辦法，你只能：

* 配合它的結構，把檔案複製進 `bin`
* 或寫一個 Build script / Post-build event 自動複製檔案，避免手動搞錯

---

### 小總結：

| 情況              | 建議做法                                                      |
| --------------- | --------------------------------------------------------- |
| DLL 只需要自己       | 放在 `Lib\`，設引用，Copy Local                                  |
| DLL 還需讀取 bin 檔案 | 用 Post-build 把 DLL 和它需要的檔案從 `LibVendorRuntime\` 複製進 `bin` |
| DLL 有硬編碼路徑限制    | 只能配合它的要求擺檔案                                               |

---

